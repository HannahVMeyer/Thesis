\chapter{LiMMBo applied to multi-trait GWAS  in \emph{Saccharomyces cerevisiae}}
\label{chapter:yeast}
In the previous chapter, I introduced LiMMBo and showed its calibration and power on simulated datasets. In this chapter, I will explore its utility on a real dataset. Amongst the publically available studies, such as flowering, defense and developmental phenotypes in \textit{Arabidopsis thaliana} \citep{Atwell2010} or human blood metabolites \citep{Shin2014}, I found the dataset of 46 quantitative traits in yeast generated and analysed in the study by Bloom and colleagues \citep{Bloom2013} most suitable for several reasons. First, they investigated the growth of a yeast F2 cross on several different substrates.  The genetic architecture of an F2 cross is highly structured, making it an ideal test scenario for a linear mixed model capable of adjusting and profiting from population structure in the sample. Second, the measured phenotypic traits have a broad spectrum of correlation, with highly related phenotypes for metabolically similar compounds to very low correlation between certain chemicals. At the same time, the phenotypic measurements are all obtained by measuring the growth size of the colonies and hence, the variable type and unit is the same across phenotypes. Lastly, the collection and quality control of the data were well described and the data were easily accessible in a user-friendly format. However, as with many studies where multiple measurements per sample are obtained, not all samples were fully phenotyped. 

In the following chapter, I will first describe the data processing and imputation strategy for the yeast phenotypes. I will then show the results of applying LiMMBo and subsequent multi-trait GWAS to the dataset and compare the results to the association obtained from single-trait GWAS. Finally, I will explore the benefits of jointly modelling large numbers of traits in genetic studies.

Like linear mixed models and methods based theron, LiMMBo requires fully phenotyped samples as the model cannot deal with missing values. In order to understand how to deal with missing values in the dataset, it is important to have an understanding of the underlying process generating the missing data \citep{Rubin1976}. In general, one can distinguish between three processes, missing completely at random (MCAR), missing at random (MAR) and missing not at random (MNAR) \citep{Little2002}. Their formal definitions are based on the data \(X  \in R^{N,P}\),  the binary indicator matrix \(M  \in R^{N,P}\)  and \(\phi\), the (unknown) parameter of the missing data process, i.e. the parameter of the conditional distribution \(g_\phi\) of \(M\) given \(X\). \(N\) is the number of observations and \(P\) the number of observed variables. Entries in \(M\) take two values,  \(m_{ij} = 1 \) if an observation is missing or  \(m_{ij} = 0\) if it is observed. The data \(X\) can formally be grouped into \(X=X_\text{obs} + X_\text{miss}\), where \(X_\text{obs}\) and  \(X_\text{miss}\) are the observed and missing parts of the data, respectively. Data are MAR if the distribution of missingness only depends on \(X_{\text{obs}}\)
\begin{equation}
g_\phi(M | X, \phi) =  g_\phi(M | X_{\text{obs}}, \phi)  \forall \, X_\text{miss}, \phi.
\end{equation}
If the distribution is also independent of \(X_{obs}\), 
\begin{equation}
g_\phi(M | X, \phi) =  g_\phi(M | \phi) \forall \, X, \phi,
\end{equation}
the data is MCAR. If, on the other hand, the distribution of missingness is dependent on \(X_{\text{miss}}\), hence
\begin{equation}
g_\phi(M | X, \phi) =  g_\phi(M | (X_{\text{obs}}, X_{\text{miss}}),\phi) \forall \, X, \phi,
\end{equation}
the data is classfied as MNAR. To illustrate these cases, consider an example where there are \(N\) colonies of yeast and one wants to automatically detect the size and the density of each colony with a suitable instrument (\(P=2\)). If the instrument fails with a constant probabilty \(\phi\) for any colony independent of the measurement, then the pattern of missing values in the data is MCAR. If the probability that the density measurement is missing changes with the value of the size measurement, but is not dependent on the density of colonies with the same size, then the data are MAR. In contrast, data are MNAR if the probability of obtaining a density measurement depends on the density of colonies with the same size. 

In practice, detecting the missing data mechanism often proves difficult. Testing for MCAR can be done via statistical tests \citep{Little1988}, but distinguishing between MAR and MNAR cannot be achieved formally as this would require knowledge of the missing values \citep{Little2002,vanBuuren2011}. However, there are visualisation tools that provide diagnostic plots and approximate measures which can help make assumptions about the missingness mechanism \citep{Templ2012,Garson2015}. 

When analysing datasets with missing data, there are four general approaches to choose from:  i) methods simply based on the complete data, ii) methods based on complete data with weighting procedures, iii) model-based and iv) imputation-based procedures. In the first class, incompletely recorded samples are simply excluded, which is the most easy to implement method, but is inefficient and can lead to major bias, especially if the data is MNAR \citep{Little2002}. Weighting procedures also exclude incompletely sampled data, but apply a weighting to the recorded samples, where the weights attempt to adjust for the missing data as if it were part of the sample design. Model-based procedures define a model for the observed data and base inference and parameter estimates on the likelihood or posterior distribution of that model. The last class of methods, imputation-based approaches, estimate the missing values based on the observed values and the completed dataset can be analysed by standard methods (an extensive review of the different methods can be found in \citep{Little2002}). The precise usage of the methods and underlying assumptions will be dependent on the missing data mechanism. 

I found the imputation approach most applicable for dealing with the missing phenotype values in the yeast dataset as they were simple to apply, did not lead to a decreased sample size and possible loss in power (as method i would have) and did not require recasting the model underlying LiMMBo (as would have been required for method iii). There are a vast number of imputation methods available, which can be categorised by both the method for imputation and the number of times the missing values are imputated. Methods include simple mean prediction, where the missing data for a given variable is replaced by the mean of all known values of that variable and derivations thereof such as KNN or FKM, which use the mean of the k-nearest neighbours to replace the missing values \citep{Troyanskaya2001,Li2004}. Instead of imputing based on the mean, i.e. the centre of a distribution, other strategies use random draws from a predictive distribution of plausible values of the missing value, where the predictive distribution is conditioned on the observed data. These techniques can then be used to either impute one value for each missing item (single imputation) or more than one value to account for imputation uncertainty (multiple imputation) \citep{Little2002}. For complex datasets, multiple imputation has emerged as the method of choice \citep{Rubin1987,Schafer1997}. 

